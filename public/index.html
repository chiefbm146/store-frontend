<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="./js/clean-url.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Store Platform - Build Your Store in Minutes</title>

    <meta property="og:type" content="website">
    <meta property="og:title" content="Your Store Platform - Build Your Store in Minutes">
    <meta property="og:description" content="Create a professional online store with AI-powered chat - no coding required">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>üè™</text></svg>">

    <!-- Critical CSS - Loading Animation (Inlined for Performance) -->
    <style>
        /* App Shell Loading State */
        body.is-loading {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        body.is-loading .hero-section,
        body.is-loading .features-section,
        body.is-loading .chat-section,
        body.is-loading .about-section,
        body.is-loading .cta-section,
        body.is-loading footer {
            display: none;
        }

        /* Loading Container */
        #loading-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 24px;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        body:not(.is-loading) #loading-container {
            opacity: 0;
            pointer-events: none;
        }

        /* Loading Spinner */
        .spinner {
            position: relative;
            width: 60px;
            height: 60px;
        }

        .spinner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 3px solid rgba(99, 102, 241, 0.1);
            border-radius: 50%;
        }

        .spinner::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 3px solid transparent;
            border-top-color: #6366f1;
            border-right-color: #6366f1;
            border-radius: 50%;
            animation: spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        /* Loading Text */
        .loading-text {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #6b7280;
            letter-spacing: 0.025em;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        /* Content Fade-In */
        body:not(.is-loading) .hero-section,
        body:not(.is-loading) .features-section,
        body:not(.is-loading) .chat-section,
        body:not(.is-loading) .about-section,
        body:not(.is-loading) .cta-section,
        body:not(.is-loading) footer {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>

    <!-- CSS -->
    <link rel="stylesheet" href="./css/desktop.css">
    <link rel="stylesheet" href="./libs/fontawesome/all.min.css">

    <!-- Flatpickr -->
    <link rel="stylesheet" href="./libs/flatpickr/flatpickr.min.css">
    <script src="./libs/flatpickr/flatpickr.min.js"></script>
</head>
<body class="is-loading">
    <!-- Loading Animation -->
    <div id="loading-container">
        <div class="spinner"></div>
        <div class="loading-text">Loading your store...</div>
    </div>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <span class="hero-icon" id="hero-icon"></span>
            <h1 class="hero-title" id="hero-title"></h1>
            <p class="hero-subtitle" id="hero-subtitle"></p>
            <p class="hero-description" id="hero-description"></p>
            <div class="hero-buttons">
                <a href="/demo-desk.html" class="btn btn-primary" id="hero-cta-primary"></a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
        <div class="section-header">
            <h2 class="section-title" id="features-title"></h2>
            <p class="section-subtitle" id="features-subtitle"></p>
        </div>
        <div class="features-grid" id="features-grid">
            <!-- Populated by JS -->
        </div>
    </section>

    <!-- Chat Section -->
    <section class="chat-section" id="chat">
        <div class="chat-wrapper">
            <div class="section-header">
                <h2 class="section-title" id="chat-title"></h2>
                <p class="section-subtitle" id="chat-subtitle"></p>
            </div>

            <div class="chat-container">
                <div class="chat-header">
                    <h3 class="chat-title">AI Chat Assistant</h3>
                </div>

                <div class="messages-container" id="messagesContainer">
                    <div class="messages" id="messages"></div>
                    <div class="typing-indicator" id="typingIndicator">
                        <span class="typing-dot"></span>
                        <span class="typing-dot"></span>
                        <span class="typing-dot"></span>
                    </div>
                    <div id="moduleContainer"></div>
                </div>

                <div class="input-area">
                    <div class="input-wrapper">
                        <input type="text" id="userInput" placeholder="Ask about our products, services, or workshops..." autocomplete="off" maxlength="4000">
                    </div>
                    <button id="sendButton">Send</button>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section class="about-section" id="about">
        <div class="about-content">
            <div class="about-text">
                <h2 id="about-title"></h2>
                <h3 id="about-subtitle"></h3>
                <div id="about-paragraphs">
                    <!-- Populated by JS -->
                </div>
            </div>
            <div class="about-visual">
                <span class="about-emoji" id="about-emoji"></span>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="cta-content">
            <h2 id="cta-title"></h2>
            <p id="cta-description"></p>
            <a href="/shop-desk.html" class="btn btn-primary" id="cta-button"></a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p class="footer-tagline" id="footer-tagline"></p>
            <div class="footer-links" id="footer-links">
                <!-- Populated by JS -->
            </div>
            <p class="footer-copyright" id="footer-copyright"></p>
        </div>
    </footer>

    <!-- Hidden audio player for TTS -->
    <audio id="ttsPlayer" style="display: none;"></audio>

    <!-- Scripts -->
    <script src="./js/version-manager.js"></script>
    <script src="./js/device-detector.js"></script>

    <!-- Config System: Theme & Content -->
    <script type="module">
        import { injectTheme } from './js/theme-injector.js';
        import desktopPage from './js/config/content/desktop.js';

        // Inject theme IMMEDIATELY (synchronous)
        injectTheme();

        // Populate landing page content
        document.addEventListener('DOMContentLoaded', () => {
            // Hero Section
            document.getElementById('hero-icon').textContent = desktopPage.hero.icon;
            document.getElementById('hero-title').textContent = desktopPage.hero.title;
            document.getElementById('hero-subtitle').textContent = desktopPage.hero.subtitle;
            document.getElementById('hero-description').textContent = desktopPage.hero.description;
            document.getElementById('hero-cta-primary').textContent = desktopPage.hero.ctaPrimary.text;
            document.getElementById('hero-cta-primary').href = desktopPage.hero.ctaPrimary.link;
            document.getElementById('hero-cta-primary').setAttribute('data-loaded', 'true');

            // Features Section
            document.getElementById('features-title').textContent = desktopPage.features.title;
            document.getElementById('features-subtitle').textContent = desktopPage.features.subtitle;

            const featuresGrid = document.getElementById('features-grid');
            featuresGrid.innerHTML = desktopPage.features.items.map(feature => `
                <div class="feature-card">
                    <span class="feature-icon">${feature.icon}</span>
                    <h3 class="feature-title">${feature.title}</h3>
                    <p class="feature-description">${feature.description}</p>
                </div>
            `).join('');

            // Chat Section
            document.getElementById('chat-title').textContent = desktopPage.chat.title;
            document.getElementById('chat-subtitle').textContent = desktopPage.chat.subtitle;
            document.getElementById('userInput').placeholder = desktopPage.chat.placeholder;

            // About Section
            document.getElementById('about-title').textContent = desktopPage.about.title;
            document.getElementById('about-subtitle').textContent = desktopPage.about.subtitle;
            document.getElementById('about-emoji').textContent = desktopPage.about.emoji;

            const aboutParagraphs = document.getElementById('about-paragraphs');
            aboutParagraphs.innerHTML = desktopPage.about.content.map(p => `<p>${p}</p>`).join('');

            // CTA Section
            document.getElementById('cta-title').textContent = desktopPage.cta.title;
            document.getElementById('cta-description').textContent = desktopPage.cta.description;
            document.getElementById('cta-button').textContent = desktopPage.cta.buttonText;
            document.getElementById('cta-button').href = desktopPage.cta.buttonLink;

            // Footer
            document.getElementById('footer-tagline').textContent = desktopPage.footer.tagline;
            document.getElementById('footer-copyright').textContent = desktopPage.footer.copyright;

            const footerLinks = document.getElementById('footer-links');
            footerLinks.innerHTML = desktopPage.footer.links.map(link =>
                `<a href="${link.url}">${link.text}</a>`
            ).join('');

            console.log('[Index] Platform landing page loaded from config');

            // Remove loading state - trigger fade-out and content reveal
            // Use requestAnimationFrame to ensure DOM updates are complete
            requestAnimationFrame(() => {
                document.body.classList.remove('is-loading');

                // Remove loading container from DOM after fade-out completes
                setTimeout(() => {
                    const loadingContainer = document.getElementById('loading-container');
                    if (loadingContainer) {
                        loadingContainer.remove();
                    }
                }, 500); // Match CSS transition duration
            });
        });
    </script>

    <!-- Service Worker for Caching -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('[ServiceWorker] Registered successfully:', registration.scope);
                    })
                    .catch(error => {
                        console.log('[ServiceWorker] Registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
